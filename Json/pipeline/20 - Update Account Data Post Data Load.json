{
	"name": "20 - Update Account Data Post Data Load",
	"properties": {
		"activities": [
			{
				"name": "Update Account for Ascent Type",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": "SELECT\n\n[Id]\n\n, type as [Ascent_Account_Type__c]\n    \n  FROM [current_sf].[Account_all]\n\n  where type = 'Customer'\n",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SalesforceServiceCloudSink",
						"writeBatchSize": 5000,
						"writeBehavior": "upsert",
						"externalIdFieldName": "id",
						"ignoreNullValues": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SynapseDedicatedPool2",
						"type": "DatasetReference",
						"parameters": {
							"cw_schema": "current_sf",
							"cw_table": "account_all"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "SalesforceServiceCloud1",
						"type": "DatasetReference",
						"parameters": {
							"cw_objectApiName": "account"
						}
					}
				]
			},
			{
				"name": "Update Account set QB Invoice Account and Sync",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Update Account for Ascent Type",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": "SELECT [Id]\n    \n      , case when [ParentId] is not null then parentid else null end as [QB_Invoice_Account__c]\n\n   \n      ,  case when parentid is null then cast(1 as bit) else cast(0 as bit) end as [Sync_Account_to_QB__c] \n  \n    \n  FROM [current_sf].[Account_all]\n\n  where type = 'Customer'\n\n",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SalesforceServiceCloudSink",
						"writeBatchSize": 5000,
						"writeBehavior": "upsert",
						"externalIdFieldName": "id",
						"ignoreNullValues": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SynapseDedicatedPool2",
						"type": "DatasetReference",
						"parameters": {
							"cw_schema": "current_sf",
							"cw_table": "account_all"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "SalesforceServiceCloud1",
						"type": "DatasetReference",
						"parameters": {
							"cw_objectApiName": "account"
						}
					}
				]
			},
			{
				"name": "Upsert Original Ower to Account",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Update Account set QB Invoice Account and Sync",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": "SELECT  a.id as id\n\n\t      ,f.[infoformatted] as [Original_Owner__c]\n\t\n     \n  FROM ( select distinct recordid, infoformatted from [current_fb].[customfieldview] where cfname = 'CS Rep') f\n  \n  join\n\n  current_sf.account_all a\n  \n  on f.recordid = a.Fishbowl_ID__c\n  ",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SalesforceServiceCloudSink",
						"writeBatchSize": 5000,
						"writeBehavior": "upsert",
						"externalIdFieldName": "id",
						"ignoreNullValues": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SynapseDedicatedPool2",
						"type": "DatasetReference",
						"parameters": {
							"cw_schema": "current_qb",
							"cw_table": "customfieldview"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "SalesforceServiceCloud1",
						"type": "DatasetReference",
						"parameters": {
							"cw_objectApiName": "account"
						}
					}
				]
			},
			{
				"name": "Update Account set Payment Terms and Invoice Method",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Upsert Original Ower to Account",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": "\nselect a.id,\n\n\ncase when paymentterms = 'Due on receipt' then 'Due Upon Receipt'\n\t when paymentterms = 'COD' or paymentterms = 'Net 15' then null\n\t else paymentterms end\n\nas [Default_Payment_Terms__c]\n\n\n\n\n,   case when f.toBeEmailed = 1 then 'Email/Online' \n\t\t\twhen f.tobeEmailed = 0 and f.tobeprinted = 1 then 'Physical Mail' end as [Preferred_Invoice_Method__c]\n\n\nfrom current_fb.customer f\n\njoin\n\ncurrent_sf.account_all a\n\non \n\nf.id  = a.fishbowl_id__c",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SalesforceServiceCloudSink",
						"writeBatchSize": 5000,
						"writeBehavior": "upsert",
						"externalIdFieldName": "id",
						"ignoreNullValues": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SynapseDedicatedPool2",
						"type": "DatasetReference",
						"parameters": {
							"cw_schema": "current_fb",
							"cw_table": "customer"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "SalesforceServiceCloud1",
						"type": "DatasetReference",
						"parameters": {
							"cw_objectApiName": "account"
						}
					}
				]
			},
			{
				"name": "Update Account Primary Purchase Type",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "Update Account set Payment Terms and Invoice Method",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": "select distinct a.id, case when f.info = 'Direct Purchase' then 'Direct Sale'\n\t\t\twhen info = 'Consignment' then 'Consignment'\n\t\t\telse null\n\t\t\tend as [Primary_Purchase_Type__c]\n\n\nfrom current_fb.customfieldview  f\n\njoin\n\ncurrent_sf.account_all a\n\non f.recordid = a.fishbowl_id__c\n\n\nwhere  f.cfname = 'Consignment or Direct Purchase'",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "SalesforceServiceCloudSink",
						"writeBatchSize": 5000,
						"writeBehavior": "upsert",
						"externalIdFieldName": "id",
						"ignoreNullValues": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SynapseDedicatedPool2",
						"type": "DatasetReference",
						"parameters": {
							"cw_schema": "current_fb",
							"cw_table": "customer"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "SalesforceServiceCloud1",
						"type": "DatasetReference",
						"parameters": {
							"cw_objectApiName": "account"
						}
					}
				]
			}
		],
		"folder": {
			"name": "zzz_GoLivePipelines/z_PostDataLoad_updates"
		},
		"annotations": [],
		"lastPublishTime": "2021-10-19T12:54:35Z"
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}